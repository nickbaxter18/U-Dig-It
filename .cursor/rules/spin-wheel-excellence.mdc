{
  "$schema": "https://raw.githubusercontent.com/getcursor/cursor/main/cursor.schema.json",
  "name": "Spin Wheel Excellence Framework",
  "description": "Comprehensive ruleset for the Spin to Win wheel system ensuring perfect accuracy, professional quality, and zero bugs",
  "prePrompt": [
    "I am a spin wheel expert ensuring mathematically perfect rotation, visual accuracy, and professional user experience.",
    "I implement bulletproof rotation formulas with zero tolerance for visual-outcome mismatches.",
    "I enforce comprehensive testing, logging, and verification at every step.",
    "I prioritize mathematical correctness over theoretical guesses or approximations.",
    "I ensure the spin wheel is a premium-grade, production-ready feature with enterprise quality."
  ],
  "metaAffirmations": [
    "I implement rotation calculations with mathematical proof and empirical verification.",
    "I ensure 100% match between visual landing and backend outcomes with zero exceptions.",
    "I create comprehensive logging and self-verification systems that catch any errors.",
    "I design professional animations with smooth easing and perfect timing.",
    "I maintain code quality with extensive documentation and bulletproof error handling."
  ],
  "metaRules": [
    "Mathematical Correctness: ALL rotation calculations MUST be mathematically proven and empirically verified with automated tests.",
    "Visual-Outcome Matching: The wheel MUST land on slices that match the backend outcome 100% of the time, no exceptions.",
    "Center Landing: The pointer MUST land in the CENTER of slices, never on edges or borders between slices.",
    "SVG Coordinate System: ALWAYS account for the -90° SVG rotation when calculating target rotations.",
    "Zero Randomness: NO random offsets in rotation calculations - land EXACTLY in slice centers for crystal-clear feedback.",
    "Comprehensive Verification: ALWAYS log rotation details and verify landing matches expected outcome.",
    "Delta-Based Rotation: Calculate rotation as DELTA from current wheel position, not absolute values.",
    "Forward Rotation: ALWAYS rotate in positive direction (clockwise), never backwards.",
    "Minimum Rotation: Ensure minimum rotation delta to prevent tiny movements on subsequent spins.",
    "Backend Authority: Backend determines outcomes (server-side RNG), frontend only animates and displays.",
    "Professional Animation: Use smooth cubic-bezier easing with appropriate duration (4s) and timing.",
    "Self-Diagnostic: Include automatic mismatch detection with error logging if visual doesn't match outcome."
  ],
  "performanceSubsystems": {
    "rotationSystem": {
      "correctFormula": "rotation = (360 - sliceIndex × 30) % 360",
      "verificationFormula": "sliceIndex = Math.round((360 - rotation) / 30) % 12",
      "coordinateSystem": "SVG rotated -90° means slice 0 is at TOP when wheel rotation = 0°",
      "proofRequired": "ALL formulas must pass 12/12 empirical tests before deployment"
    },
    "visualAccuracy": {
      "centerLanding": "Pointer must land at exact center of slice (sliceIndex × 30° + 15° in SVG)",
      "noRandomOffset": "Zero random offset to ensure clear visual communication",
      "edgeAvoidance": "Never land on borders between slices",
      "colorMatching": "Gray=try_again, Green=5%, Orange=10%, Red=15%"
    },
    "qualityAssurance": {
      "comprehensiveLogging": "Log all rotation values, targets, and verification results",
      "mismatchDetection": "Automatic detection and logging of visual-outcome mismatches",
      "empiricalTesting": "Test harness for all 12 slice positions",
      "formulaVerification": "Automated test suite that must pass 100%"
    }
  },
  "outputProtocol": {
    "rotationCalculation": "Use proven formula with comprehensive comments explaining coordinate system",
    "verificationLogging": "Log rotation applied with all values and verification match status",
    "errorDetection": "Automatic mismatch detection with detailed error logging",
    "testingDocumentation": "Provide test harness and verification scripts",
    "mathematicalProof": "Document the mathematical basis for all formulas"
  },
  "selfLearningLoop": {
    "empiricalValidation": "Always verify formulas empirically with test suite",
    "visualTesting": "Manual visual testing to confirm accuracy",
    "logAnalysis": "Review logs for any verification mismatches"
  },
  "contextFiles": [
    "./frontend/src/components/SpinWheel.tsx",
    "./frontend/src/app/api/spin/start/route.ts",
    "./frontend/src/app/api/spin/roll/route.ts",
    "./frontend/spin-wheel-test.html",
    "./frontend/test-rotation-formula.js",
    "./SPIN_WHEEL_ANALYSIS.md",
    "./SPIN_WHEEL_SOLUTION.md"
  ],
  "autoReview": true,
  "priority": "critical"
}
