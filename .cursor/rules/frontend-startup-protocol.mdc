---
description: Frontend startup protocol - ALWAYS follow when starting/restarting the dev server
globs: []
alwaysApply: true
---

# Frontend Startup Protocol

## ğŸ¯ Critical Rule - ALWAYS Follow

### Starting the Development Server

**ONLY use these approved methods:**

1. **Automatic (Preferred)** - Cursor auto-starts on folder open âœ…
2. **VS Code Task** - Run "Start Frontend Port 3000" task âœ…
3. **Terminal** - `bash start-frontend-clean.sh` âœ…
4. **pnpm** - `cd frontend && pnpm dev` âœ…

**NEVER do this:**
- âŒ `cd frontend && pnpm next dev` (bypasses optimizations)
- âŒ `cd frontend && next dev` (bypasses optimizations)
- âŒ Manually clearing `.next` before start (defeats caching)
- âŒ Running without port cleanup (causes conflicts)

## Why This Matters

**Our setup is optimized with:**
- âš¡ **Turbopack filesystem caching** - 70% faster restarts (3-5s vs 15-20s)
- ğŸ§¹ **Automatic port cleanup** - No manual intervention needed
- ğŸ”’ **Lock file handling** - Prevents stale lock errors
- ğŸ”„ **Process cleanup** - No zombie processes

**Using raw `next dev` bypasses ALL of this!**

## Quick Reference

```bash
# âœ… CORRECT - Use the optimized script
bash start-frontend-clean.sh

# âœ… CORRECT - Or use pnpm dev (configured to use script)
cd frontend && pnpm dev

# âŒ WRONG - Bypasses optimizations
cd frontend && pnpm next dev
```

## Emergency Deep Clean

**Only use when experiencing cache corruption:**
```bash
bash start-frontend-deep-clean.sh
```

**Symptoms requiring deep clean:**
- Build errors persist after fixing code
- Strange behavior after multiple restarts
- Turbopack cache corruption errors

## Configuration Files

**These are already configured correctly - don't change them:**

### package.json
```json
{
  "scripts": {
    "dev": "bash ../start-frontend-clean.sh"  // âœ… Uses optimized script
  }
}
```

### next.config.js
```javascript
{
  experimental: {
    turbopackFileSystemCacheForDev: true  // âœ… Enables fast restarts
  }
}
```

### .vscode/tasks.json
```json
{
  "label": "Start Frontend Port 3000",
  "command": "cd frontend && pnpm dev",  // âœ… Uses optimized script
  "runOptions": {
    "runOn": "folderOpen"  // âœ… Auto-starts on Cursor open
  }
}
```

## Documentation

Full details: `@STARTUP_OPTIMIZATION.md`

## Related Rules

- `@nextjs-startup-optimization.mdc` - Detailed optimization guide
- `@development-workflow.mdc` - Daily workflow including startup

---

**Remember: The startup script is not just a convenience - it's a performance optimization that saves 10-15 seconds on every restart!**
